<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Respons√°vel - Sistema Escolar</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Menu de Acessibilidade -->
    <div class="accessibility-menu">
        <button class="accessibility-toggle">
            ‚ôø Acessibilidade
        </button>
        <div class="accessibility-options" id="accessibilityOptions">
            <a href="#" onclick="toggleAccessibility('daltonismo')">Modo Dalt√¥nico</a>
            <a href="#" onclick="toggleAccessibility('preto-e-branco')">Preto e Branco</a>
            <a href="#" onclick="toggleAccessibility('nenhum')">Restaurar Padr√£o</a>
        </div>
    </div>

    <!-- Legendas de Acessibilidade -->
    <button class="legend-toggle" onclick="toggleLegend()">Ver Legenda (Daltonismo)</button>
    <div class="daltonismo-legend" id="daltonismoLegend">
        <button class="legend-close-btn" onclick="toggleLegend()" aria-label="Fechar legenda">√ó</button>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #0066cc;">‚òÖ</div>
            <span class="legend-text">Excelente</span>
        </div>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #666666;">‚óè</div>
            <span class="legend-text">Bom</span>
        </div>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #cc6600;">‚ñ≤</div>
            <span class="legend-text">Regular / Aten√ß√£o</span>
        </div>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #000000;">‚úñ</div>
            <span class="legend-text">Insatisfat√≥rio</span>
        </div>
    </div>

    <button class="pb-legend-toggle" onclick="togglePbLegend()">Ver Legenda (P&B)</button>
    <div class="pb-legend" id="pbLegend">
        <button class="legend-close-btn" onclick="togglePbLegend()" aria-label="Fechar legenda">√ó</button>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #666;">‚ñ†</div>
            <span class="legend-text">Excelente</span>
        </div>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #666;">‚óè</div>
            <span class="legend-text">Bom</span>
        </div>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #666;">‚ñ≤</div>
            <span class="legend-text">Regular / Aten√ß√£o</span>
        </div>
        <div class="legend-item">
            <div class="legend-symbol" style="background: #666;">‚úñ</div>
            <span class="legend-text">Insatisfat√≥rio</span>
        </div>
    </div>

    <!-- Elementos Decorativos -->
    <div class="bg-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
        <div class="shape shape-4"></div>
    </div>

    <div class="app-container">
        <!-- DASHBOARD RESPONS√ÅVEL -->
        <div class="page active" id="dashboardResponsavelPage">
            <div class="main-layout">
                <nav class="sidebar">
                    <div class="menu-item active" onclick="showResponsavelSection('boletim')">
                        <div class="menu-icon">üìã</div>
                        <span>Boletim</span>
                    </div>

                    <div class="menu-item" onclick="showResponsavelSection('frequencia')">
                        <div class="menu-icon">üìÖ</div>
                        <span>Frequ√™ncia</span>
                    </div>

                    <div class="menu-item" onclick="showResponsavelSection('perfil')">
                        <div class="menu-icon">üë§</div>
                        <span>Perfil</span>
                    </div>

                    <div class="menu-item" onclick="logout()">
                        <div class="menu-icon">üö™</div>
                        <span>Sair</span>
                    </div>
                </nav>

                <main class="main-content">
                    <!-- SE√á√ÉO BOLETIM DO FILHO -->
                    <div id="responsavelBoletimSection">
                        <div class="boletim-container">
                            <div class="bd-header">
                                <div class="bd-perfil">
                                    <img src="https://via.placeholder.com/64x80" alt="Foto do aluno" class="bd-avatar-oval" width="64" height="80">
                                    <div class="bd-perfil-info">
                                        <strong class="bd-perfil-nome" id="responsavelFilhoNome">Maria Silva</strong>
                                        <div class="bd-perfil-meta" id="responsavelFilhoInfo">Matr√≠cula: 2309567 ‚Ä¢ Turma: 2¬∫A</div>
                                    </div>
                        </div>
                                <div class="bd-projk">ProJK</div>
                        </div>

                            <div class="bd-toolbar" role="region" aria-label="Op√ß√µes de acessibilidade">
                                <button type="button" class="bd-btn" data-action="font-dec" aria-label="Diminuir texto">A‚àí</button>
                                <button type="button" class="bd-btn" data-action="font-inc" aria-label="Aumentar texto">A+</button>
                                <button type="button" class="bd-btn" data-action="contrast" aria-label="Alto contraste">‚óê</button>
                                <button type="button" class="bd-btn" data-action="dyslexia" aria-label="Fonte para dislexia">ùëì</button>
                                <button type="button" class="bd-btn" data-action="reduce-motion" aria-label="Reduzir anima√ß√µes">‚óé</button>
                                <button type="button" class="bd-btn" data-action="print" aria-label="Exportar PDF">üñ®</button>
                            </div>

                        <h3 class="boletim-title">üìã Boletim do Filho</h3>
                        
                        <!-- Seletor Visual de Simulado (destaca coluna) -->
                        <div style="text-align: center; margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 10px; font-weight: 600; color: #2c3e50; font-size: 14px;">
                                üéØ Destacar simulado:
                            </label>
                            <div style="display: inline-flex; gap: 8px; padding: 8px; background: linear-gradient(135deg, #f8f9fa, #ffffff); border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                                <button class="simulado-btn active" onclick="destacarSimuladoResponsavel(1)" data-simulado="1">
                                    üìù 1
                                </button>
                                <button class="simulado-btn" onclick="destacarSimuladoResponsavel(2)" data-simulado="2">
                                    üìù 2
                                </button>
                                <button class="simulado-btn" onclick="destacarSimuladoResponsavel(3)" data-simulado="3">
                                    üìù 3
                                </button>
                                <button class="simulado-btn" onclick="destacarSimuladoResponsavel(4)" data-simulado="4">
                                    üìù 4
                                </button>
                                <button class="simulado-btn" onclick="destacarSimuladoResponsavel(0)" data-simulado="0">
                                    üëÅÔ∏è Todos
                                </button>
                            </div>
                        </div>

                        <div class="tab-headers">
                            <div class="tab-header"><strong>üìö Disciplina</strong></div>
                            <div class="tab-header active" data-col="1">üìù Simulado 1</div>
                            <div class="tab-header" data-col="2">üìù Simulado 2</div>
                            <div class="tab-header" data-col="3">üìù Simulado 3</div>
                            <div class="tab-header" data-col="4">üìù Simulado 4</div>
                        </div>

                            <table class="grades-table">
                                <tr>
                                    <td class="subject-cell">Portugu√™s</td>
                                    <td class="grade-cell grade-bom destaque-col-1">Bom</td>
                                    <td class="grade-cell grade-excelente">Excelente</td>
                                    <td class="grade-cell grade-bom">Bom</td>
                                    <td class="grade-cell grade-excelente">Excelente</td>
                                </tr>
                                <tr>
                                    <td class="subject-cell">Matem√°tica</td>
                                    <td class="grade-cell grade-excelente destaque-col-1">Excelente</td>
                                    <td class="grade-cell grade-excelente">Excelente</td>
                                    <td class="grade-cell grade-bom">Bom</td>
                                    <td class="grade-cell grade-excelente">Excelente</td>
                                </tr>
                                <tr>
                                    <td class="subject-cell">Ci√™ncias</td>
                                    <td class="grade-cell grade-bom destaque-col-1">Bom</td>
                                    <td class="grade-cell grade-bom">Bom</td>
                                    <td class="grade-cell grade-excelente">Excelente</td>
                                    <td class="grade-cell grade-bom">Bom</td>
                                </tr>
                            </table>

                            <!-- Se√ß√£o de Observa√ß√µes do Professor -->
                            <div class="observacoes-section">
                                <h3 class="observacoes-title">üìù Observa√ß√µes dos Professores</h3>
                                
                                <div class="observacao-card">
                                    <div class="observacao-header">
                                        <span class="observacao-disciplina">üìö Matem√°tica</span>
                                        <span class="observacao-data">15/10/2024</span>
                                    </div>
                                    <div class="observacao-professor">Prof. Carlos Silva</div>
                                    <div class="observacao-texto">
                                        Aluna demonstra excelente desempenho em todas as atividades. Participa ativamente das aulas e auxilia os colegas. Recomendo continuar incentivando a pr√°tica di√°ria de exerc√≠cios.
                                    </div>
                            </div>

                                <div class="observacao-card">
                                    <div class="observacao-header">
                                        <span class="observacao-disciplina">üìñ Portugu√™s</span>
                                        <span class="observacao-data">12/10/2024</span>
                                    </div>
                                    <div class="observacao-professor">Profa. Ana Costa</div>
                                    <div class="observacao-texto">
                                        √ìtimo progresso na leitura e interpreta√ß√£o de textos. Sugiro aumentar o h√°bito de leitura em casa para continuar desenvolvendo as habilidades lingu√≠sticas.
                                    </div>
                            </div>

                                <div class="observacao-card">
                                    <div class="observacao-header">
                                        <span class="observacao-disciplina">üî¨ Ci√™ncias</span>
                                        <span class="observacao-data">10/10/2024</span>
                                    </div>
                                    <div class="observacao-professor">Prof. Roberto Mendes</div>
                                    <div class="observacao-texto">
                                        Demonstra curiosidade e interesse pelos temas cient√≠ficos. Participa√ß√£o ativa nos experimentos em laborat√≥rio. Continuar estimulando a curiosidade cient√≠fica.
                                    </div>
                                </div>
                            </div>

                            <div class="status-section">
                                <h2 class="status-title">üìä Status</h2>
                                <div class="status-indicators">
                                    <div class="status-indicator status-muito-bem">üåü Est√° muito bem</div>
                                    <div class="status-indicator status-bem">‚úÖ Est√° bem</div>
                                    <div class="status-indicator status-atencao">‚ö†Ô∏è Requer aten√ß√£o</div>
                                    <div class="status-indicator status-mal">‚ùå Est√° mal</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- SE√á√ÉO FREQU√äNCIA -->
                    <div id="responsavelFrequenciaSection" style="display: none;">
                        <h1 style="font-size: 24px; color: #333; margin-bottom: 30px;">Frequ√™ncia Escolar</h1>

                        <div style="background: #f8f9fa; padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                            <h3 style="color: #333; margin-bottom: 15px;">Resumo do M√™s</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                                <div style="text-align: center;">
                                    <div style="font-size: 32px; font-weight: bold; color: #4CAF50;">22</div>
                                    <div style="color: #666;">Dias Presentes</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 32px; font-weight: bold; color: #FF9800;">2</div>
                                    <div style="color: #666;">Faltas</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 32px; font-weight: bold; color: #2196F3;">88%</div>
                                    <div style="color: #666;">Frequ√™ncia</div>
                                </div>
                            </div>
                        </div>

                        <div style="background: white; border: 1px solid #eee; border-radius: 15px; padding: 20px;">
                            <h4 style="margin-bottom: 15px;">√öltimas Aus√™ncias</h4>
                            <div style="color: #666;">
                                <p>‚Ä¢ 15/08/2024 - Falta justificada (atestado m√©dico)</p>
                                <p>‚Ä¢ 12/08/2024 - Falta n√£o justificada</p>
                            </div>
                        </div>
                    </div>

                    <!-- SE√á√ÉO PERFIL RESPONS√ÅVEL -->
                    <div id="responsavelPerfilSection" style="display: none;">
                        <div class="photo-section">
                            <h2 style="font-size: 18px; margin-bottom: 20px;">PERFIL DO RESPONS√ÅVEL</h2>
                            <div class="user-photo" onclick="changePhoto()">üë§</div>
                            <h1 class="user-name" id="responsavelPerfilNome">Jos√© Silva</h1>
                            <div class="discipline-badge" id="responsavelPerfilCpf">CPF: ***.***.*89-00</div>
                        </div>

                        <!-- Informa√ß√µes do Aluno Vinculado -->
                        <div style="background: linear-gradient(135deg, #e3f2fd, #f5f5f5); padding: 25px; border-radius: 15px; margin: 30px 0; border-left: 5px solid #2196F3;">
                            <h3 style="color: #2196F3; font-size: 18px; margin-bottom: 15px; text-align: center;">üë®‚Äçüë©‚Äçüëß Aluno Vinculado</h3>
                            <div style="background: #fff3cd; padding: 10px; border-radius: 8px; margin-bottom: 15px; font-size: 12px; color: #856404; text-align: center;">
                                üîí <strong>Seguran√ßa:</strong> CPFs s√£o exibidos parcialmente protegidos
                            </div>
                            <div style="display: grid; gap: 15px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 10px;">
                                    <strong style="color: #C19A2B;">üë§ Nome:</strong>
                                    <span id="alunoVinculadoNome">Jo√£o Silva</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 10px;">
                                    <strong style="color: #C19A2B;">üé´ Matr√≠cula:</strong>
                                    <span id="alunoVinculadoMatricula">2024001</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 10px;">
                                    <strong style="color: #C19A2B;">üîí CPF:</strong>
                                    <span id="alunoVinculadoCpf" style="font-family: monospace; letter-spacing: 1px;">***.***.*33-44</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 10px;">
                                    <strong style="color: #C19A2B;">üéÇ Data de Nascimento:</strong>
                                    <span id="alunoVinculadoNascimento">15/03/2010</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 10px;">
                                    <strong style="color: #C19A2B;">üè´ Turma:</strong>
                                    <span id="alunoVinculadoTurma">2¬™ S√©rie A</span>
                                </div>
                            </div>
                        </div>

                        <div style="text-align: center; display: flex; gap: 15px; justify-content: center;">
                            <button class="btn btn-edit" onclick="editResponsavelProfile()">
                                <span style="font-size: 18px; margin-right: 8px;">‚úèÔ∏è</span>
                                Editar Perfil
                            </button>
                            <button class="btn btn-save" onclick="saveResponsavelProfile()">
                                <span style="font-size: 18px; margin-right: 8px;">üíæ</span>
                                Salvar
                            </button>
                        </div>
                    </div>
                </main>
            </div>
        </div>

        <div class="corner-decoration bottom-left"></div>
        <div class="corner-decoration bottom-right"></div>
    </div>

    <script src="script.js"></script>
    <script>
        // Fun√ß√£o de navega√ß√£o para p√°ginas separadas
        function navigateToPage(page) {
            window.location.href = page;
        }

        // Modificar fun√ß√£o logout para redirecionar
        function logout() {
            localStorage.removeItem('currentUser');
            showAlert('Logout realizado com sucesso!', 'success');
            setTimeout(() => navigateToPage('login.html'), 1500);
        }

        // Vari√°veis globais
        let currentAccessibilityMode = 'nenhum';
        let fontSize = 100;

        // Fun√ß√£o para alternar acessibilidade
        function toggleAccessibility(mode) {
            const body = document.body;
            const daltonismoLegend = document.getElementById('daltonismoLegend');
            const pbLegend = document.getElementById('pbLegend');
            
            // Remover modos anteriores
            body.classList.remove('daltonismo-mode', 'preto-e-branco-mode');
            daltonismoLegend.classList.remove('show');
            pbLegend.classList.remove('show');
            
            currentAccessibilityMode = mode;
            
            if (mode === 'daltonismo') {
                body.classList.add('daltonismo-mode');
                daltonismoLegend.classList.add('show');
                showAlert('Modo Dalt√¥nico ativado! Legenda exibida.', 'success');
            } else if (mode === 'preto-e-branco') {
                body.classList.add('preto-e-branco-mode');
                pbLegend.classList.add('show');
                showAlert('Modo Preto e Branco ativado! Legenda exibida.', 'success');
            } else {
                showAlert('Modo de visualiza√ß√£o padr√£o restaurado.', 'success');
            }
            
            // Fechar menu de acessibilidade ap√≥s sele√ß√£o
            document.getElementById('accessibilityOptions').classList.remove('show');
        }
        
        // Fun√ß√£o para alternar legenda de daltonismo
        function toggleLegend() {
            const legend = document.getElementById('daltonismoLegend');
            legend.classList.toggle('show');
        }
        
        // Fun√ß√£o para alternar legenda P&B
        function togglePbLegend() {
            const legend = document.getElementById('pbLegend');
            legend.classList.toggle('show');
        }
        
        // Fechar legendas ao clicar fora
        document.addEventListener('click', function(e) {
            const daltonismoLegend = document.getElementById('daltonismoLegend');
            const pbLegend = document.getElementById('pbLegend');
            const legendToggle = document.querySelector('.legend-toggle');
            const pbLegendToggle = document.querySelector('.pb-legend-toggle');
            
            if (daltonismoLegend && daltonismoLegend.classList.contains('show')) {
                if (!daltonismoLegend.contains(e.target) && e.target !== legendToggle && !legendToggle.contains(e.target)) {
                    daltonismoLegend.classList.remove('show');
                }
            }
            
            if (pbLegend && pbLegend.classList.contains('show')) {
                if (!pbLegend.contains(e.target) && e.target !== pbLegendToggle && !pbLegendToggle.contains(e.target)) {
                    pbLegend.classList.remove('show');
                }
            }
        });
        
        // Fechar legendas com ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const daltonismoLegend = document.getElementById('daltonismoLegend');
                const pbLegend = document.getElementById('pbLegend');
                if (daltonismoLegend) daltonismoLegend.classList.remove('show');
                if (pbLegend) pbLegend.classList.remove('show');
            }
        });

        // Verificar se o usu√°rio est√° logado
        document.addEventListener('DOMContentLoaded', function() {
            const accessibilityToggle = document.querySelector('.accessibility-toggle');
            const accessibilityOptions = document.getElementById('accessibilityOptions');
            
            if (accessibilityToggle) {
                accessibilityToggle.addEventListener('click', function(e) {
                    e.stopPropagation();
                    accessibilityOptions.classList.toggle('show');
                });
            }
            
            // Fechar menu ao clicar fora
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.accessibility-menu')) {
                    accessibilityOptions.classList.remove('show');
                }
            });
            
            // Carregar dados do usu√°rio do localStorage
            const userData = localStorage.getItem('currentUser');
            if (!userData) {
                navigateToPage('login.html');
                return;
            }

            const currentUser = JSON.parse(userData);
            if (currentUser.type !== 'responsavel') {
                navigateToPage('login.html');
                return;
            }

            // Atualizar informa√ß√µes do perfil do respons√°vel
            const nomeElement = document.getElementById('responsavelPerfilNome');
            const cpfElement = document.getElementById('responsavelPerfilCpf');
            if (nomeElement) nomeElement.textContent = currentUser.name;
            if (cpfElement) {
                const cpfMascarado = mascararCPF(currentUser.cpfResponsavel || currentUser.cpf);
                cpfElement.textContent = `CPF: ${cpfMascarado}`;
            }
            
            // Buscar aluno vinculado
            let alunoVinculado = null;
            if (currentUser.cpfAlunoVinculado) {
                // Buscar nos usu√°rios cadastrados
                const todosUsuarios = Object.values(users);
                alunoVinculado = todosUsuarios.find(u => u.type === 'aluno' && u.cpfAluno === currentUser.cpfAlunoVinculado);
            }
            
            // Se tiver dados salvos do aluno vinculado, usar
            if (currentUser.alunoVinculado) {
                alunoVinculado = currentUser.alunoVinculado;
            }
            
            // Atualizar informa√ß√µes do aluno vinculado na tela
            if (alunoVinculado) {
                // Header do boletim
                const filhoNomeEl = document.getElementById('responsavelFilhoNome');
                const filhoInfoEl = document.getElementById('responsavelFilhoInfo');
                if (filhoNomeEl) filhoNomeEl.textContent = alunoVinculado.nome || alunoVinculado.name;
                if (filhoInfoEl) filhoInfoEl.textContent = `Matr√≠cula: ${alunoVinculado.matricula} ‚Ä¢ Turma: ${alunoVinculado.serie}¬™${alunoVinculado.turma}`;
                
                // Se√ß√£o de perfil - dados do aluno
                const alunoNomeEl = document.getElementById('alunoVinculadoNome');
                const alunoMatriculaEl = document.getElementById('alunoVinculadoMatricula');
                const alunoCpfEl = document.getElementById('alunoVinculadoCpf');
                const alunoNascimentoEl = document.getElementById('alunoVinculadoNascimento');
                const alunoTurmaEl = document.getElementById('alunoVinculadoTurma');
                
                if (alunoNomeEl) alunoNomeEl.textContent = alunoVinculado.nome || alunoVinculado.name;
                if (alunoMatriculaEl) alunoMatriculaEl.textContent = alunoVinculado.matricula;
                if (alunoCpfEl) {
                    const cpfAlunoMascarado = mascararCPF(alunoVinculado.cpf || alunoVinculado.cpfAluno);
                    alunoCpfEl.textContent = cpfAlunoMascarado;
                }
                if (alunoNascimentoEl) {
                    const dataNasc = alunoVinculado.dataNascimento;
                    if (dataNasc) {
                        const dataFormatada = new Date(dataNasc + 'T00:00:00').toLocaleDateString('pt-BR');
                        alunoNascimentoEl.textContent = dataFormatada;
                    }
                }
                if (alunoTurmaEl) alunoTurmaEl.textContent = `${alunoVinculado.serie}¬™ S√©rie ${alunoVinculado.turma}`;
            } else {
                showAlert('Aten√ß√£o: Nenhum aluno vinculado encontrado!', 'error');
            }
            
            // Funcionalidade dos bot√µes da toolbar
            const toolbar = document.querySelector('.bd-toolbar');
            if (toolbar) {
                toolbar.addEventListener('click', function(e) {
                    const btn = e.target.closest('.bd-btn');
                    if (!btn) return;
                    
                    const action = btn.dataset.action;
                    
                    switch(action) {
                        case 'font-dec':
                            adjustFontSize(-1);
                            break;
                        case 'font-inc':
                            adjustFontSize(1);
                            break;
                        case 'contrast':
                            toggleHighContrast();
                            break;
                        case 'dyslexia':
                            toggleDyslexiaFont();
                            break;
                        case 'reduce-motion':
                            toggleReducedMotion();
                            break;
                        case 'print':
                            exportBoletimFilhoPDF();
                            break;
                    }
                });
            }
        });
        
        // Fun√ß√µes auxiliares da toolbar (sem redeclara√ß√£o)
        function adjustFontSize(delta) {
            if (typeof fontSize === 'undefined') {
                window.fontSize = 100;
            }
            fontSize = Math.max(80, Math.min(120, fontSize + delta * 10));
            document.documentElement.style.fontSize = fontSize + '%';
            showAlert(`Tamanho da fonte: ${fontSize}%`, 'success');
        }
        
        function toggleHighContrast() {
            document.body.classList.toggle('high-contrast');
            const isActive = document.body.classList.contains('high-contrast');
            showAlert(isActive ? 'Alto contraste ativado' : 'Alto contraste desativado', 'success');
        }
        
        function toggleDyslexiaFont() {
            document.body.classList.toggle('dyslexia-font');
            const isActive = document.body.classList.contains('dyslexia-font');
            showAlert(isActive ? 'Fonte para dislexia ativada' : 'Fonte padr√£o restaurada', 'success');
        }
        
        function toggleReducedMotion() {
            document.body.classList.toggle('reduced-motion');
            const isActive = document.body.classList.contains('reduced-motion');
            showAlert(isActive ? 'Anima√ß√µes reduzidas' : 'Anima√ß√µes restauradas', 'success');
        }
        
        function exportBoletimFilhoPDF() {
            const userData = localStorage.getItem('currentUser');
            if (!userData) {
                showAlert('Erro: Usu√°rio n√£o encontrado!', 'error');
                return;
            }

            const currentUser = JSON.parse(userData);
            showAlert('Gerando PDF do boletim...', 'success');
            
            // Dados do boletim do filho
            const disciplinas = [
                { nome: 'Frequ√™ncia', bim1: '88%', bim2: '95%', bim3: '90%', bim4: '92%' },
                { nome: 'Portugu√™s', bim1: '8.2', bim2: '9.0', bim3: '8.5', bim4: '9.2' },
                { nome: 'Matem√°tica', bim1: '9.1', bim2: '9.5', bim3: '8.8', bim4: '9.3' },
                { nome: 'Ci√™ncias', bim1: '8.0', bim2: '8.5', bim3: '9.0', bim4: '8.7' },
                { nome: 'Hist√≥ria', bim1: '7.8', bim2: '8.2', bim3: '8.0', bim4: '8.3' },
                { nome: 'Comportamento', bim1: 'Excelente', bim2: 'Excelente', bim3: 'Bom', bim4: 'Excelente' }
            ];
            
            const observacoes = [
                {
                    disciplina: 'üìö Matem√°tica',
                    professor: 'Prof. Carlos Silva',
                    data: '15/10/2024',
                    texto: 'Aluna demonstra excelente desempenho em todas as atividades. Participa ativamente das aulas e auxilia os colegas. Recomendo continuar incentivando a pr√°tica di√°ria de exerc√≠cios.'
                },
                {
                    disciplina: 'üìñ Portugu√™s',
                    professor: 'Profa. Ana Costa',
                    data: '12/10/2024',
                    texto: '√ìtimo progresso na leitura e interpreta√ß√£o de textos. Sugiro aumentar o h√°bito de leitura em casa para continuar desenvolvendo as habilidades lingu√≠sticas.'
                },
                {
                    disciplina: 'üî¨ Ci√™ncias',
                    professor: 'Prof. Roberto Mendes',
                    data: '10/10/2024',
                    texto: 'Demonstra curiosidade e interesse pelos temas cient√≠ficos. Participa√ß√£o ativa nos experimentos em laborat√≥rio. Continuar estimulando a curiosidade cient√≠fica.'
                }
            ];
            
            // Criar conte√∫do HTML para o PDF
            let htmlContent = `
                <html>
                <head>
                    <style>
                        body { 
                            font-family: 'Segoe UI', Arial, sans-serif; 
                            padding: 40px; 
                            background: #f8f9fa; 
                        }
                        .container { 
                            background: white; 
                            padding: 40px; 
                            border-radius: 15px; 
                            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); 
                        }
                        h1 { 
                            color: #D4AF37; 
                            text-align: center; 
                            margin-bottom: 10px; 
                            font-size: 32px;
                            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
                        }
                        .subtitle { 
                            color: #C19A2B; 
                            text-align: center;
                            margin-bottom: 30px; 
                            font-size: 16px; 
                        }
                        .info-section { 
                            background: linear-gradient(135deg, #f5f3e8, #ede8d5); 
                            padding: 20px; 
                            border-radius: 12px; 
                            margin-bottom: 25px;
                            border-left: 5px solid #D4AF37;
                        }
                        .info-section p { 
                            margin: 8px 0; 
                            color: #555; 
                        }
                        table { 
                            width: 100%; 
                            border-collapse: separate; 
                            border-spacing: 0; 
                            margin-top: 25px;
                            border-radius: 12px;
                            overflow: hidden;
                            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.08);
                        }
                        th { 
                            background: linear-gradient(135deg, #D4AF37, #C19A2B); 
                            color: white; 
                            padding: 15px 12px; 
                            text-align: center;
                            font-weight: 600;
                            font-size: 13px;
                            text-transform: uppercase;
                            letter-spacing: 0.5px;
                        }
                        th:first-child {
                            text-align: left;
                        }
                        td { 
                            border-bottom: 1px solid #e0e0e0; 
                            padding: 14px 12px;
                            background: white;
                            color: #333;
                            text-align: center;
                        }
                        td:first-child {
                            text-align: left;
                            font-weight: 600;
                            color: #C19A2B;
                        }
                        tr:nth-child(even) td { 
                            background: #fafafa; 
                        }
                        tr:last-child td { 
                            border-bottom: none; 
                        }
                        
                        .observacoes-section {
                            margin-top: 40px;
                        }
                        
                        .observacoes-title {
                            color: #D4AF37;
                            font-size: 22px;
                            margin-bottom: 20px;
                            border-bottom: 3px solid #D4AF37;
                            padding-bottom: 10px;
                        }
                        
                        .observacao-box {
                            background: linear-gradient(135deg, #f5f3e8, #ede8d5);
                            padding: 20px;
                            border-radius: 12px;
                            margin-bottom: 20px;
                            border-left: 5px solid #2196F3;
                            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
                        }
                        
                        .obs-header {
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            margin-bottom: 12px;
                            flex-wrap: wrap;
                            gap: 10px;
                        }
                        
                        .obs-disciplina {
                            font-weight: bold;
                            color: #2196F3;
                            font-size: 16px;
                        }
                        
                        .obs-data {
                            color: #888;
                            font-size: 13px;
                        }
                        
                        .obs-professor {
                            color: #C19A2B;
                            font-weight: 600;
                            margin-bottom: 10px;
                            font-size: 14px;
                        }
                        
                        .obs-texto {
                            color: #555;
                            line-height: 1.6;
                            font-size: 14px;
                        }
                        
                        .footer { 
                            margin-top: 40px; 
                            text-align: center; 
                            font-size: 12px; 
                            color: #888;
                            padding-top: 30px;
                            border-top: 2px solid #D4AF37;
                        }
                        .footer p { 
                            margin: 5px 0; 
                        }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <h1>üìã Boletim Escolar</h1>
                        <div class="subtitle">Sistema Escolar JK - Visualiza√ß√£o Respons√°vel</div>
                        
                        <div class="info-section">
                            <p><strong>üë§ Estudante:</strong> ${currentUser.alunoVinculado?.nome || 'N√£o informado'}</p>
                            <p><strong>üé´ Matr√≠cula:</strong> ${currentUser.alunoVinculado?.matricula || 'N√£o informado'}</p>
                            <p><strong>üîí CPF (Protegido):</strong> ${mascararCPF(currentUser.alunoVinculado?.cpf)}</p>
                            <p><strong>üè´ Turma:</strong> ${currentUser.alunoVinculado?.serie}¬™ S√©rie ${currentUser.alunoVinculado?.turma}</p>
                            <p><strong>üë®‚Äçüë©‚Äçüëß Respons√°vel:</strong> ${currentUser.name}</p>
                            <p><strong>üìÖ Data de Emiss√£o:</strong> ${new Date().toLocaleDateString('pt-BR')} √†s ${new Date().toLocaleTimeString('pt-BR')}</p>
                        </div>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Disciplina</th>
                                    <th>1¬∫ Bimestre</th>
                                    <th>2¬∫ Bimestre</th>
                                    <th>3¬∫ Bimestre</th>
                                    <th>4¬∫ Bimestre</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${disciplinas.map(disc => `
                                    <tr>
                                        <td>${disc.nome}</td>
                                        <td>${disc.bim1}</td>
                                        <td>${disc.bim2}</td>
                                        <td>${disc.bim3}</td>
                                        <td>${disc.bim4}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                        
                        <div class="observacoes-section">
                            <h3 class="observacoes-title">üìù Observa√ß√µes dos Professores</h3>
                            ${observacoes.map(obs => `
                                <div class="observacao-box">
                                    <div class="obs-header">
                                        <span class="obs-disciplina">${obs.disciplina}</span>
                                        <span class="obs-data">${obs.data}</span>
                                    </div>
                                    <div class="obs-professor">${obs.professor}</div>
                                    <div class="obs-texto">${obs.texto}</div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="footer">
                            <p><strong>Sistema Escolar JK - Gest√£o Acad√™mica</strong></p>
                            <p>Boletim gerado para o respons√°vel</p>
                            <p>${new Date().toLocaleString('pt-BR')}</p>
                        </div>
                    </div>
                </body>
                </html>
            `;
            
            // Criar e fazer download do PDF
            const printWindow = window.open('', '', 'height=800,width=1000');
            printWindow.document.write(htmlContent);
            printWindow.document.close();
            
            setTimeout(() => {
                printWindow.print();
                showAlert('PDF gerado! Use a op√ß√£o "Salvar como PDF" na janela de impress√£o.', 'success');
            }, 500);
        }
        
        function toggleHighContrast() {
            document.body.classList.toggle('high-contrast');
            const isActive = document.body.classList.contains('high-contrast');
            showAlert(isActive ? 'Alto contraste ativado' : 'Alto contraste desativado', 'success');
        }
        
        function toggleDyslexiaFont() {
            document.body.classList.toggle('dyslexia-font');
            const isActive = document.body.classList.contains('dyslexia-font');
            showAlert(isActive ? 'Fonte para dislexia ativada' : 'Fonte padr√£o restaurada', 'success');
        }
        
        function toggleReducedMotion() {
            document.body.classList.toggle('reduced-motion');
            const isActive = document.body.classList.contains('reduced-motion');
            showAlert(isActive ? 'Anima√ß√µes reduzidas' : 'Anima√ß√µes restauradas', 'success');
        }
    </script>
</body>
</html>
